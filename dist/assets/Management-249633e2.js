import{u as Ne,r as u,o as we,y as $,v as le,a as d,b as g,d as t,j as v,S as De,k,m as r,l as a,q as N,t as K,z as Ie,A as Ae,F as Ce,B as ne,C as Ve,x as oe,V as Le,D as Be,e as ze}from"./index-2c8b3d33.js";import{u as Me,_ as j}from"./useManagementUtils-71ee99f5.js";var i={},_,f;function Y(){throw new Error("setTimeout has not been defined")}function X(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?_=setTimeout:_=Y}catch{_=Y}try{typeof clearTimeout=="function"?f=clearTimeout:f=X}catch{f=X}})();function re(o){if(_===setTimeout)return setTimeout(o,0);if((_===Y||!_)&&setTimeout)return _=setTimeout,setTimeout(o,0);try{return _(o,0)}catch{try{return _.call(null,o,0)}catch{return _.call(this,o,0)}}}function Oe(o){if(f===clearTimeout)return clearTimeout(o);if((f===X||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(o);try{return f(o)}catch{try{return f.call(null,o)}catch{return f.call(this,o)}}}var y=[],w=!1,T,M=-1;function Ue(){!w||!T||(w=!1,T.length?y=T.concat(y):M=-1,y.length&&ie())}function ie(){if(!w){var o=re(Ue);w=!0;for(var s=y.length;s;){for(T=y,y=[];++M<s;)T&&T[M].run();M=-1,s=y.length}T=null,w=!1,Oe(o)}}i.nextTick=function(o){var s=new Array(arguments.length-1);if(arguments.length>1)for(var p=1;p<arguments.length;p++)s[p-1]=arguments[p];y.push(new ue(o,s)),y.length===1&&!w&&re(ie)};function ue(o,s){this.fun=o,this.array=s}ue.prototype.run=function(){this.fun.apply(null,this.array)};i.title="browser";i.browser=!0;i.env={};i.argv=[];i.version="";i.versions={};function x(){}i.on=x;i.addListener=x;i.once=x;i.off=x;i.removeListener=x;i.removeAllListeners=x;i.emit=x;i.prependListener=x;i.prependOnceListener=x;i.listeners=function(o){return[]};i.binding=function(o){throw new Error("process.binding is not supported")};i.cwd=function(){return"/"};i.chdir=function(o){throw new Error("process.chdir is not supported")};i.umask=function(){return 0};const Fe=["src","title"],Se=ne("h1",{style:{color:"red","font-weight":"bold","text-align":"center"}}," Nincs bejelentkezve! ",-1),$e={__name:"Management",setup(o){console.log("Karbantartás!!!");const s=Ne(),p=u(null),D=s.currentRoute.value.params.type;var Q=D=="AT";const se=u(!1),O=u("");u(null);const ce=u(""),pe=u(""),H=u(null),G=u(null),J=u(null),c=u(null),U=u(!1),F=u(!1),S=u(!1),P=u(!1),W=u(null),Z=u("green"),I=u(null),{titlevalue:h,keyvalue:b,keyID:Re,newtitle:ee,modifytitle:de,deletetitle:te,resultData:R,setMetaByCat:ve,setItem:_e}=Me();we(async()=>{if(console.log("onMounted, cat: ",s.currentRoute.value.params.type),$.value==!0){ve(s.currentRoute.value.params.type);const n=await le(D);n&&(p.value=n),console.log("data: ",p)}console.log("onMounted után")});const A=u([]);D==="AT"?A.value=[{title:h,key:b},{title:"Nemzetiség",key:"NN_COUNTRYCODE"},{title:"Műveletek",key:"actions",sortable:!1}]:A.value=[{title:h,key:b},{title:"Műveletek",key:"actions",sortable:!1}],console.log("head: ",A);async function fe(){const n=Be,e=n.utils.book_new(),m=n.utils.json_to_sheet(p.value);n.utils.book_append_sheet(e,m,pe.value),n.writeFile(e,ce.value)}function me(){window.scrollTo(0,0)}async function ge(){try{console.log("fetchBookData - selectedItem: ",c.value.AT_ID),I.value=await ze.get("/api/data/books/"+c.value.AT_ID),console.log("booksForAuthor: ",I.value.data[0].cnt)}catch(n){console.log(n.response)}}function ye(n){c.value=n,Ve(()=>{U.value=!0})}async function ae(n,e){console.log("item: ",n),c.value=n,console.log("selectedItem: ",c.value),e=="info"&&await ge(),e=="del"?F.value=!0:S.value=!0}async function q(n,e){await _e({action:n,myDialog:e,selectedItem:c,cat:s.currentRoute.value.params.type,fetchData:le,snackbarState:{color:Z,message:W,active:P}}),console.log("resultData: ",R),R.value!=""&&(p.value=R.value)}return(n,e)=>{const m=d("v-col"),xe=d("v-card-title"),ke=d("v-card-text"),C=d("v-card"),Te=d("v-dialog"),he=d("v-text-field"),V=d("v-icon"),L=d("v-btn"),B=d("v-row"),E=d("v-tooltip"),be=d("v-container");return v(),g(be,{fluid:""},{default:t(()=>[P.value?(v(),g(De,{key:0,p_title:W.value,p_color:Z.value},null,8,["p_title","p_color"])):k("",!0),r($)?(v(),g(B,{key:1},{default:t(()=>[a(m,{cols:"2"}),a(m,{cols:"8"},{default:t(()=>[c.value?(v(),g(j,{key:0,p_visible:U.value,"onUpdate:p_visible":e[0]||(e[0]=l=>U.value=l),ref_key:"myModifyDialog",ref:G,p_defvalue:c.value?c.value[r(b)]:"",p_type:"brown",p_headerTitle:r(de),p_colpadding:"padding: 0px 7px 0px 0px",p_color:"black",p_variant:"tonal",p_textFieldLabel:r(h),p_required:" true ",p_action:"upd",onSave:e[1]||(e[1]=l=>q("upd",G.value)),p_autocomplete:r(Q),p_acDefaultValue:c.value?c.value.NN_NATIONALITY:"",p_acLabel:"Nemzetiség",p_acItems:r(oe),p_acKey:n.NN_ID,p_acTitle:"NN_NATIONALITY",p_acValue:"NN_ID"},null,8,["p_visible","p_defvalue","p_headerTitle","p_textFieldLabel","p_autocomplete","p_acDefaultValue","p_acItems","p_acKey"])):k("",!0),c.value?(v(),g(j,{key:1,p_visible:F.value,"onUpdate:p_visible":e[2]||(e[2]=l=>F.value=l),ref_key:"myDeleteDialog",ref:J,p_defvalue:c.value?c.value[r(b)]:"",p_type:"brown",p_headerTitle:r(te),p_colpadding:"padding: 0px 7px 0px 0px",p_color:"black",p_variant:"tonal",p_textFieldLabel:r(te),onClose:e[3]||(e[3]=l=>q("del",J.value)),p_required:" true ",p_disabled:" true ",p_readonly:" true ",p_okBtnName:"Igen",p_cancelBtnName:"Nem"},null,8,["p_visible","p_defvalue","p_headerTitle","p_textFieldLabel"])):k("",!0),a(Te,{modelValue:S.value,"onUpdate:modelValue":e[4]||(e[4]=l=>S.value=l)},{default:t(()=>[a(C,{class:"mx-auto",rounded:"lg",elevation:"16",color:"#e3d19f",width:"400"},{default:t(()=>[a(xe,{class:"text-h6 font-weight-bold"},{default:t(()=>[N(K(c.value?.AT_AUTHORNAME)+" ("+K(I.value?.data?.[0]?.cnt||0)+" könyv) ",1)]),_:1}),(v(!0),Ie(Ce,null,Ae(I.value.data,(l,z)=>(v(),g(ke,{style:{padding:"10px 10px 0px 25px"},key:z},{default:t(()=>[N(K(l.BK_BOOKTITLE),1)]),_:2},1024))),128))]),_:1})]),_:1},8,["modelValue"]),a(C,{rounded:"lg",style:{padding:"15px","background-color":"antiquewhite"}},{default:t(()=>[p.value?(v(),g(r(Le),{key:0,style:{"background-color":"antiquewhite"},modelValue:n.selectedRow,"onUpdate:modelValue":e[9]||(e[9]=l=>n.selectedRow=l),density:"compact",headers:A.value,items:p.value,"item-value":r(b),"item-key":r(b),class:"elevation-1",search:O.value,hover:"true","multi-sort":"true","items-per-page-text":r(h)+" oldalanként","select-strategy":"page","no-data-text":"Nincs a keresésnek megfelelő "+r(h).toLowerCase()+"...",loading:se.value,"loading-text":"Betöltés... Kérem várjon","show-current-page":"true","page-text":"","onUpdate:page":e[10]||(e[10]=l=>me())},{top:t(()=>[a(C,{rounded:"lg",elevation:"6",color:"black",variant:"tonal",style:{margin:"10px 10px 10px 10px"}},{default:t(()=>[a(B,null,{default:t(()=>[a(m,{cols:"6"},{default:t(()=>[a(he,{modelValue:O.value,"onUpdate:modelValue":e[5]||(e[5]=l=>O.value=l),label:"Keresés",class:"mx-auto",clearable:"","append-inner-icon":"fas fa-magnifying-glass",style:{padding:"10px 10px 0px 10px","margin-top":"10px"},rounded:"lg",elevation:"10"},null,8,["modelValue"])]),_:1}),a(m,{cols:"2"}),a(m,{cols:"3"},{default:t(()=>[a(j,{ref_key:"myNewDialog",ref:H,p_defvalue:"",p_btnName:r(ee),p_type:"brown",p_prependicon:"fa fa-square-plus",p_headerTitle:r(ee),p_colpadding:"padding: 30px 0px 0px 0px",p_color:"black",p_size:"default",p_rounded:"lg",p_elevation:"10",p_variant:"tonal",p_textFieldLabel:r(h),onSave:e[6]||(e[6]=l=>q("add",H.value)),p_required:" true ",p_tooltipText:"Új",p_tooltipLocation:"start",p_autocomplete:r(Q),p_acDefaultValue:"",p_acLabel:"Nemzetiség",p_acItems:r(oe),p_acKey:n.NN_ID,p_acTitle:"NN_NATIONALITY",p_acValue:"NN_ID"},null,8,["p_btnName","p_headerTitle","p_textFieldLabel","p_autocomplete","p_acItems","p_acKey"])]),_:1}),a(m,{cols:"1",style:{"padding-right":"20px"}},{default:t(()=>[a(L,{modelValue:n.exportXlsxBtn,"onUpdate:modelValue":e[7]||(e[7]=l=>n.exportXlsxBtn=l),icon:"",style:{margin:"30px 0px 0px 0px",height:"36px"},rounded:"lg",elevation:"10",variant:"tonal",onClick:e[8]||(e[8]=l=>fe())},{default:t(()=>[a(V,null,{default:t(()=>[N("mdi-export")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),"item.NN_COUNTRYCODE":t(({item:l})=>[ne("img",{src:`https://flagcdn.com/w40/${l.NN_COUNTRYCODE||"un"}.png`,alt:"zászló",title:l.NN_NATIONALITY||"Nincs megadva",style:{"vertical-align":"middle"}},null,8,Fe)]),"item.actions":t(({item:l})=>[a(B,{dense:"","no-gutters":"",align:"center"},{default:t(()=>[a(L,{icon:"",style:{"margin-right":"10px"},variant:"tonal",size:"x-small",color:"black",onClick:z=>ye(l)},{default:t(()=>[a(V,null,{default:t(()=>[N("fa fa-pen-to-square")]),_:1}),a(E,{activator:"parent",text:"Módosítás",location:"left"})]),_:2},1032,["onClick"]),a(L,{icon:"",style:{"margin-right":"10px"},variant:"tonal",size:"x-small",color:"black",onClick:z=>ae(l,"del")},{default:t(()=>[a(V,null,{default:t(()=>[N("fa fa-trash")]),_:1}),a(E,{activator:"parent",text:"Törlés",location:r(D)==="AT"?"bottom":"right"},null,8,["location"])]),_:2},1032,["onClick"]),r(D)==="AT"?(v(),g(L,{key:0,icon:"",variant:"tonal",size:"x-small",color:"black",onClick:z=>ae(l,"info")},{default:t(()=>[a(V,null,{default:t(()=>[N("fas fa-info-circle")]),_:1}),a(E,{activator:"parent",text:"Szerzőhöz tartozó könyvek litája",location:"right"})]),_:2},1032,["onClick"])):k("",!0)]),_:2},1024)]),_:1},8,["modelValue","headers","items","item-value","item-key","search","items-per-page-text","no-data-text","loading"])):k("",!0)]),_:1})]),_:1}),a(m,{cols:"2"})]),_:1})):k("",!0),a(B,{align:"center",justify:"center"},{default:t(()=>[r($)?k("",!0):(v(),g(C,{key:0,rounded:"lg",elevation:"16",color:"#e3d19f",width:"600",px:""},{default:t(()=>[Se]),_:1}))]),_:1})]),_:1})}}};export{$e as default};
