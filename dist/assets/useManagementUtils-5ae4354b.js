import{r as o,w as L,a as r,j as y,b as k,d as u,l as _,C as F,D as M,q as w,t as N,k as z,E as D,F as O,A as P,e as U}from"./index-53315596.js";const H={key:2,class:"text-h6 pa-2"},R={__name:"MyDialog",props:{p_visible:Boolean,p_defvalue:String,p_readonly:{type:Boolean,default:!1},p_disabled:{type:Boolean,default:!1},p_btnName:String,p_type:String,p_headerTitle:String,p_title:String,p_size:{type:String,default:"default"},p_variant:{type:String,default:"elevated"},p_elevation:{type:String,default:"0"},p_okBtnName:{type:String,default:"Mentés"},p_cancelBtnName:{type:String,default:"Mégsem"},p_rounded:{type:String,default:"lg"},p_color:{type:String,default:"primary"},p_icon:String,p_prependicon:String,p_colpadding:{type:String,default:"padding: 0px 0px 0px 0px"},p_textFieldLabel:String,p_required:{type:Boolean,default:!1},p_action:{type:String,default:""},p_tooltipText:{type:String,default:""},p_tooltipLocation:{type:String,default:"end"},p_autocomplete:{type:Boolean,default:!1},p_acDefaultValue:{type:String,default:""},p_acLabel:{type:String,default:""},p_acItems:{type:String,default:""},p_acKey:{type:String,default:""},p_acTitle:{type:String,default:""},p_acValue:{type:String,default:""},p_acErrorMsg:{type:String,default:""}},emits:["update:p_visible","close","save"],setup(e,{expose:m,emit:c}){const i=e;o(!1);const s=o("X"),t=o(""),a=o(""),d=o(""),f=o(!0),p=o(!1),x=c;L(()=>i.p_visible,n=>{console.log("props.p_visible changed to:",n),p.value=n}),L(p,n=>{p&&i.p_defvalue?t.value=i.p_defvalue:t.value="",a&&i.p_acDefaultValue&&(a.value=i.p_acDefaultValue),p&&i.p_autocomplete&&!i.p_acDefaultValue&&(a.value=null),console.log("autocomplete: ",a),x("update:p_visible",n),console.log("dialogVisible watch"),!n&&s.value!="CANCEL"&&(console.log("res: ",s.value,n),x("close"))});function g(){x("close"),P(()=>{x("save","upd",t.value,a.value)})}m({res:s,fieldTextValue:t,autocompleteValue:a,close:g});function V(){t.value!=""&&t.value!=null&&console.log("fieldTextValue: ",t.value)}function B(n){f.value=!1,console.log("resVal: ",n),s.value=n,p.value=!1,console.log("fieldTextValue onClose: ",t.value),a.value=""}return(n,l)=>{const b=r("v-icon"),T=r("v-tooltip"),S=r("v-btn"),C=r("v-toolbar"),j=r("v-text-field"),I=r("v-autocomplete"),$=r("v-card-text"),E=r("v-card-actions"),K=r("v-card"),h=r("v-dialog"),q=r("v-col");return y(),k(E,{style:{padding:"0"}},{default:u(()=>[_(q,{cols:"auto",style:F(e.p_colpadding)},{default:u(()=>[_(h,{modelValue:p.value,"onUpdate:modelValue":l[7]||(l[7]=A=>p.value=A),persistent:"",transition:"dialog-top-transition",width:"auto"},{activator:u(({props:A})=>[e.p_btnName||e.p_icon?(y(),k(S,M({key:0,icon:e.p_icon,size:e.p_size,variant:e.p_variant,rounded:e.p_rounded,elevation:e.p_elevation,color:e.p_color},A,{disabled:e.p_disabled,"prepend-icon":e.p_prependicon}),{default:u(()=>[e.p_icon?(y(),k(b,{key:0},{default:u(()=>[w(N(e.p_icon),1)]),_:1})):z("",!0),e.p_tooltipText!=""?(y(),k(T,{key:1,activator:"parent",location:e.p_tooltipLocation,text:e.p_tooltipText},null,8,["location","text"])):z("",!0),w(" "+N(e.p_btnName),1)]),_:2},1040,["icon","size","variant","rounded","elevation","color","disabled","prepend-icon"])):z("",!0)]),default:u(({isActive:A})=>[_(K,{rounded:"lg",elevation:"16",color:"#e3d19f"},{default:u(()=>[e.p_headerTitle?(y(),k(C,{key:0,rounded:"lg",elevation:"16",density:"compact",color:e.p_type,title:e.p_headerTitle},null,8,["color","title"])):z("",!0),_($,null,{default:u(()=>[e.p_textFieldLabel?(y(),k(j,{key:0,autofocus:"",style:{"min-width":"250px"},modelValue:t.value,"onUpdate:modelValue":[l[0]||(l[0]=v=>t.value=v),l[1]||(l[1]=v=>t.value?d.value="":d.value="Kötelező mező")],clearable:!e.p_readonly,readonly:e.p_readonly,label:e.p_readonly?"":e.p_textFieldLabel,variant:"solo-filled",required:e.p_required,rules:[v=>!!v],"error-messages":d.value,onKeydown:[l[2]||(l[2]=D(v=>V(),["enter"])),l[3]||(l[3]=D(v=>n.onCancel("CANCEL"),["esc"]))]},null,8,["modelValue","clearable","readonly","label","required","rules","error-messages"])):z("",!0),e.p_autocomplete?(y(),k(I,{style:{"min-width":"250px"},clearable:"",modelValue:a.value,"onUpdate:modelValue":l[4]||(l[4]=v=>a.value=v),label:e.p_acLabel,items:e.p_acItems,key:e.p_acKey,"item-title":e.p_acTitle,"item-value":e.p_acValue,variant:"solo-filled","return-object":"",density:"compact","no-data-text":"Nincs a keresésnek megfelelő adat",required:!0,"error-messages":e.p_acErrorMsg},null,8,["modelValue","label","items","item-title","item-value","error-messages"])):z("",!0),e.p_title?(y(),O("div",H,N(e.p_title),1)):z("",!0)]),_:1}),_(K,{variant:"tonal"},{default:u(()=>[_(E,{class:"justify-end",style:{"min-height":"auto"}},{default:u(()=>[_(S,M({disabled:(d.value!=""||t.value==""||t.value==null)&&e.p_textFieldLabel,variant:"tonal",density:"compact",color:e.p_color},i,{onClick:l[5]||(l[5]=v=>(x("save",i.p_action,t.value,a.value),B("OK")))}),{default:u(()=>[w(N(e.p_okBtnName),1)]),_:1},16,["disabled","color"]),_(S,{variant:"tonal",density:"compact",onClick:l[6]||(l[6]=v=>B("CANCEL"))},{default:u(()=>[w(N(e.p_cancelBtnName),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["style"])]),_:1})}}};function Y(){const e=o(""),m=o(""),c=o(""),i=o(""),s=o(""),t=o(""),a=o(""),d=o(""),f=o("");function p(g){switch(g){case"AT":e.value="Szerző",m.value="AT_AUTHORNAME",c.value="AT_ID",i.value="AT_NN_ID",s.value="Új szerző",t.value="Szerző módosítása",a.value="Biztos végleg törli a szerzőt?",d.value="authors.xlsx",f.value="Szerzők";break;case"CG":e.value="Műfaj",m.value="CG_CATEGORY",c.value="CG_ID",s.value="Új műfaj",t.value="Műfaj módosítása",a.value="Biztos végleg törli a műfajt?",d.value="category.xlsx",f.value="Műfajok";break;case"BT":console.log("Kategóriák!!!"),e.value="Kategória",m.value="BT_TYPENAME",c.value="BT_ID",s.value="Új kategória",t.value="Kategória módosítása",a.value="Biztos végleg törli a kategóriát?",d.value="booktype.xlsx",f.value="Kategóriák";break;case"OS":console.log("Státuszok!!!"),e.value="Státusz",m.value="OS_NAME",c.value="OS_ID",s.value="Új státusz",t.value="Státusz módosítása",a.value="Biztos végleg törli a státuszt?",d.value="ownershipstatus.xlsx",f.value="Státuszok";break;case"PS":console.log("Kiadók!!!"),e.value="Kiadó",m.value="PS_PUBLISHERNAME",c.value="PS_ID",s.value="Új kiadó",t.value="Kiadó módosítása",a.value="Biztos végleg törli a kiadót?",d.value="publisher.xlsx",f.value="Kiadók";break}}async function x({action:g,myDialog:V,selectedItem:B,cat:n,fetchData:l,snackbarState:b}){const T=o(""),S=g==="add"?"felvitele":g==="upd"?"módosítása":"törlése";b.color.value="red";try{console.log("myDialog: ",V),(await U.post(`/${g}/${n}`,{name:V.fieldTextValue,id:g==="add"?-1:B?.value?.[c.value],nationalityid:n==="AT"&&V.autocompleteValue?V.autocompleteValue.NN_ID:null}))?.status==200?(T.value=`A ${e.value.toLowerCase()} ${S} sikeresen megtörtént!`,b.color.value="green",await l(n)):T.value=`Hiba történt a ${e.value.toLowerCase()} ${S} közben!`}catch(C){console.error("Hiba:",C),T.value=C?.response?.status===400?"Nem törölhető, mert van hozzárendelve könyv!":`Hiba történt a ${e.value.toLowerCase()} ${S} közben!`}b.message.value=T.value,b.active.value=!0,setTimeout(()=>{b.active.value=!1},5e3)}return{titlevalue:e,keyvalue:m,keyID:c,acKeyID:i,newtitle:s,modifytitle:t,deletetitle:a,xlsxFilename:d,xlsxSheetname:f,setMetaByCat:p,setItem:x}}export{R as _,Y as u};
