import{r as a,w as L,a as v,j as _,b as z,d as u,l as b,E as O,G as M,q as w,t as C,k as V,H as j,z as P,C as U,e as F}from"./index-2c8b3d33.js";const G={key:2,class:"text-h6 pa-2"},R={__name:"MyDialog",props:{p_visible:Boolean,p_defvalue:String,p_readonly:{type:Boolean,default:!1},p_disabled:{type:Boolean,default:!1},p_btnName:String,p_type:String,p_headerTitle:String,p_title:String,p_size:{type:String,default:"default"},p_variant:{type:String,default:"elevated"},p_elevation:{type:String,default:"0"},p_okBtnName:{type:String,default:"Mentés"},p_cancelBtnName:{type:String,default:"Mégsem"},p_rounded:{type:String,default:"lg"},p_color:{type:String,default:"primary"},p_icon:String,p_prependicon:String,p_colpadding:{type:String,default:"padding: 0px 0px 0px 0px"},p_textFieldLabel:String,p_required:{type:Boolean,default:!1},p_action:{type:String,default:""},p_tooltipText:{type:String,default:""},p_tooltipLocation:{type:String,default:"end"},p_autocomplete:{type:Boolean,default:!1},p_acDefaultValue:{type:String,default:""},p_acLabel:{type:String,default:""},p_acItems:{type:String,default:""},p_acKey:{type:String,default:""},p_acTitle:{type:String,default:""},p_acValue:{type:String,default:""},p_acErrorMsg:{type:String,default:""}},emits:["update:p_visible","close","save"],setup(e,{expose:m,emit:p}){const i=e;a(!1);const s=a("X"),t=a(""),o=a(""),d=a(""),g=a(!0),r=a(!1),S=p;L(()=>i.p_visible,n=>{console.log("props.p_visible changed to:",n),r.value=n}),L(r,n=>{r&&i.p_defvalue?t.value=i.p_defvalue:t.value="",o&&i.p_acDefaultValue&&(o.value=i.p_acDefaultValue),r&&i.p_autocomplete&&!i.p_acDefaultValue&&(o.value=null),console.log("autocomplete: ",o),S("update:p_visible",n),console.log("dialogVisible watch"),!n&&s.value!="CANCEL"&&(console.log("res: ",s.value,n),S("close"))});function A(){S("close"),U(()=>{S("save","upd",t.value,o.value)})}m({res:s,fieldTextValue:t,autocompleteValue:o,close:A});function f(){t.value!=""&&t.value!=null&&console.log("fieldTextValue: ",t.value)}function T(n){g.value=!1,console.log("resVal: ",n),s.value=n,r.value=!1,console.log("fieldTextValue onClose: ",t.value),o.value=""}return(n,l)=>{const D=v("v-icon"),k=v("v-tooltip"),y=v("v-btn"),N=v("v-toolbar"),x=v("v-text-field"),I=v("v-autocomplete"),$=v("v-card-text"),E=v("v-card-actions"),K=v("v-card"),h=v("v-dialog"),q=v("v-col");return _(),z(E,{style:{padding:"0"}},{default:u(()=>[b(q,{cols:"auto",style:O(e.p_colpadding)},{default:u(()=>[b(h,{modelValue:r.value,"onUpdate:modelValue":l[7]||(l[7]=B=>r.value=B),persistent:"",transition:"dialog-top-transition",width:"auto"},{activator:u(({props:B})=>[e.p_btnName||e.p_icon?(_(),z(y,M({key:0,icon:e.p_icon,size:e.p_size,variant:e.p_variant,rounded:e.p_rounded,elevation:e.p_elevation,color:e.p_color},B,{disabled:e.p_disabled,"prepend-icon":e.p_prependicon,style:{margin:"0px 10px 0px 10px",padding:"0px 20px 0px 20px"}}),{default:u(()=>[e.p_icon?(_(),z(D,{key:0},{default:u(()=>[w(C(e.p_icon),1)]),_:1})):V("",!0),e.p_tooltipText!=""?(_(),z(k,{key:1,activator:"parent",location:e.p_tooltipLocation,text:e.p_tooltipText},null,8,["location","text"])):V("",!0),w(" "+C(e.p_btnName),1)]),_:2},1040,["icon","size","variant","rounded","elevation","color","disabled","prepend-icon"])):V("",!0)]),default:u(({isActive:B})=>[b(K,{rounded:"lg",elevation:"16",color:"#e3d19f"},{default:u(()=>[e.p_headerTitle?(_(),z(N,{key:0,rounded:"lg",elevation:"16",density:"compact",color:e.p_type,title:e.p_headerTitle},null,8,["color","title"])):V("",!0),b($,null,{default:u(()=>[e.p_textFieldLabel?(_(),z(x,{key:0,autofocus:"",style:{"min-width":"250px"},modelValue:t.value,"onUpdate:modelValue":[l[0]||(l[0]=c=>t.value=c),l[1]||(l[1]=c=>t.value?d.value="":d.value="Kötelező mező")],clearable:!e.p_readonly,readonly:e.p_readonly,label:e.p_readonly?"":e.p_textFieldLabel,variant:"solo-filled",required:e.p_required,rules:[c=>!!c],"error-messages":d.value,onKeydown:[l[2]||(l[2]=j(c=>f(),["enter"])),l[3]||(l[3]=j(c=>n.onCancel("CANCEL"),["esc"]))]},null,8,["modelValue","clearable","readonly","label","required","rules","error-messages"])):V("",!0),e.p_autocomplete?(_(),z(I,{style:{"min-width":"250px"},clearable:"",modelValue:o.value,"onUpdate:modelValue":l[4]||(l[4]=c=>o.value=c),label:e.p_acLabel,items:e.p_acItems,key:e.p_acKey,"item-title":e.p_acTitle,"item-value":e.p_acValue,variant:"solo-filled","return-object":"",density:"compact","no-data-text":"Nincs a keresésnek megfelelő adat",required:!0,"error-messages":e.p_acErrorMsg},null,8,["modelValue","label","items","item-title","item-value","error-messages"])):V("",!0),e.p_title?(_(),P("div",G,C(e.p_title),1)):V("",!0)]),_:1}),b(K,{variant:"tonal"},{default:u(()=>[b(E,{class:"justify-end",style:{"min-height":"auto"}},{default:u(()=>[b(y,M({disabled:(d.value!=""||t.value==""||t.value==null)&&e.p_textFieldLabel,variant:"tonal",density:"compact",color:e.p_color},i,{onClick:l[5]||(l[5]=c=>(S("save",i.p_action,t.value,o.value),T("OK")))}),{default:u(()=>[w(C(e.p_okBtnName),1)]),_:1},16,["disabled","color"]),b(y,{variant:"tonal",density:"compact",onClick:l[6]||(l[6]=c=>T("CANCEL"))},{default:u(()=>[w(C(e.p_cancelBtnName),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["style"])]),_:1})}}};function Y(){const e=a(""),m=a(""),p=a(""),i=a(""),s=a(""),t=a(""),o=a(""),d=a(""),g=a(""),r=a("");function S(f){switch(f){case"AT":e.value="Szerző",m.value="AT_AUTHORNAME",p.value="AT_ID",i.value="AT_NN_ID",s.value="Új szerző",t.value="Szerző módosítása",o.value="Biztos végleg törli a szerzőt?",d.value="authors.xlsx",g.value="Szerzők";break;case"CG":e.value="Műfaj",m.value="CG_CATEGORY",p.value="CG_ID",s.value="Új műfaj",t.value="Műfaj módosítása",o.value="Biztos végleg törli a műfajt?",d.value="category.xlsx",g.value="Műfajok";break;case"BT":console.log("Kategóriák!!!"),e.value="Kategória",m.value="BT_TYPENAME",p.value="BT_ID",s.value="Új kategória",t.value="Kategória módosítása",o.value="Biztos végleg törli a kategóriát?",d.value="booktype.xlsx",g.value="Kategóriák";break;case"OS":console.log("Státuszok!!!"),e.value="Státusz",m.value="OS_NAME",p.value="OS_ID",s.value="Új státusz",t.value="Státusz módosítása",o.value="Biztos végleg törli a státuszt?",d.value="ownershipstatus.xlsx",g.value="Státuszok";break;case"PS":console.log("Kiadók!!!"),e.value="Kiadó",m.value="PS_PUBLISHERNAME",p.value="PS_ID",s.value="Új kiadó",t.value="Kiadó módosítása",o.value="Biztos végleg törli a kiadót?",d.value="publisher.xlsx",g.value="Kiadók";break}}async function A({action:f,myDialog:T,selectedItem:n,cat:l,fetchData:D,snackbarState:k}){const y=a(""),N=f==="add"?"felvitele":f==="upd"?"módosítása":"törlése";k.color.value="red";try{const x=await F.post(`/${f}/${l}`,{name:T.fieldTextValue,id:f==="add"?-1:n?.value?.[p.value],nationalityid:l==="AT"&&T.autocompleteValue?T.autocompleteValue.NN_ID:null});console.log("myDialog res: ",x),x?.status==200&&(y.value=`A ${e.value.toLowerCase()} ${N} sikeresen megtörtént!`,k.color.value="green",r.value=await D(l),console.log("resultData setitem: ",r))}catch(x){console.error("Hiba:",x),x?.response?.status===409?y.value=`Ez a ${e.value.toLowerCase()} már létezik!`:y.value=x?.response?.status===400?"Nem törölhető, mert van hozzárendelve könyv!":`Hiba történt a ${e.value.toLowerCase()} ${N} közben!`}k.message.value=y.value,k.active.value=!0,setTimeout(()=>{k.active.value=!1},5e3)}return{titlevalue:e,keyvalue:m,keyID:p,acKeyID:i,newtitle:s,modifytitle:t,deletetitle:o,xlsxFilename:d,xlsxSheetname:g,resultData:r,setMetaByCat:S,setItem:A}}export{R as _,Y as u};
